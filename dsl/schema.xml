<?xml version="1.0" encoding="UTF-8"?>
<schema name="cc_asn1" endian="big">
    <fields>
        <enum name="Tag" type="uint8" forceGen="true" hexAssign="true">
            <validValue name="Boolean" val="0x1" />
            <validValue name="Integer" val="0x2" />
            <validValue name="BitString" val="0x3" />
            <validValue name="OctetString" val="0x4" />
            <validValue name="Null" val="0x5" />
            <validValue name="ObjectIdentifier" val="0x6" />
            <validValue name="Utf8String" val="0xC" />
            <validValue name="PrintableString" val="0x13" />
            <validValue name="Ia5String" val="0x16" />
            <validValue name="UtcTime" val="0x17" />
            <validValue name="GeneralizedTime" val="0x18" />
            <validValue name="Sequence" val="0x30" />
            <validValue name="Set" val="0x31" />
        </enum>

        <string name="PrintableStringVal" validOverride="replace" />

    </fields>

    <ns name="der">
        <fields>
            <bundle name="Length" semanticType="length">
                <valueOverride value="replace" />
                <readOverride value="replace" />
                <refreshOverride value="extend" />
                <validOverride value="replace" />
                <members>
                    <bitfield name="Short">
                        <int name="LenValue" type="uint8" bitLength="7">
                            <special name="MaxValue" val="0x7f" />
                        </int>
                        <set name="Flag" bitLength="1">
                            <bit name="longForm" idx="0" />
                        </set>
                    </bitfield>
                    <optional name="Long" defaultMode="missing" cond="$Short.Flag.longForm">
                        <int name="LenValue" type="uint64" availableLengthLimit="true" />
                    </optional>
                </members>
            </bundle>

            <int name="TagByte" type="uint8" failOnInvalid="true" />

            <bundle name="Boolean">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Boolean" />
                <ref field="der.Length" />
                <int name="Value" type="uint8">
                    <special name="False" val="0x0" />
                    <special name="True" val="0xff" />
                </int>
            </bundle>

            <bundle name="Integer">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Integer" />
                <ref field="der.Length" />
                <int name="Value" type="int64" availableLengthLimit="true" />
            </bundle>

            <bundle name="RawInteger">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Integer" />
                <ref field="der.Length" />
                <data name="Value" />
            </bundle>  

            <bundle name="OctetString">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.OctetString" />
                <ref field="der.Length" />
                <data name="Value" />
            </bundle>                      

            <bundle name="Null">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Null" />
                <ref field="der.Length" />
            </bundle>

            <bundle name="Utf8String">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Utf8String" />
                <ref field="der.Length" />
                <string name="Value" />
            </bundle>       

            <bundle name="PrintableString">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.PrintableString" />
                <ref field="der.Length" />
                <ref field="PrintableStringVal" name="Value" />
            </bundle>   

            <bundle name="Ia5String">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Ia5String" />
                <ref field="der.Length" />
                <string name="Value" />
            </bundle>       

            <bundle name="UtcTime">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.UtcTime" />
                <ref field="der.Length" />
                <string name="Value" />
            </bundle>

            <bundle name="GeneralizedTime">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.GeneralizedTime" />
                <ref field="der.Length" />
                <string name="Value" />
            </bundle>   

            <bundle name="Sequence">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Sequence" />
                <ref field="der.Length" />
                <bundle name="Value">
                    <description>
                        Replace this bundle with another relevant to the application.
                        Keep the members sorted by their tags.
                    </description>
                    <members>
                        <ref field="der.Null" name="Value" />
                    </members>
                </bundle>
            </bundle>      

            <bundle name="SequenceOf">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Sequence" />
                <ref field="der.Length" />
                <list name="Value">
                    <description>
                        Replace this list with another relevant to the application
                    </description>
                    <element>
                        <ref field="der.Null" name="Value" />
                    </element>
                </list>
            </bundle>

            <bundle name="Set" refreshOverride="replace">
                <int name="Tag" reuse="der.TagByte" defaultValidValue="Tag.Set" />
                <ref field="der.Length" />
                <list name="Value">
                    <description>
                        Replace this list with another relevant to the application,
                        use variant for SET or direct field in case of SETOF.
                        Keep the variant members sorted by the tag.
                    </description>
                    <element>
                        <variant name="Element">
                            <ref field="der.Null" name="Value" />
                        </variant>
                    </element>
                </list>
            </bundle>      

        </fields>
    </ns>
</schema>
